-- O(2, n) = 7n - 6 = 1 + 7(n - 1)
-- O(3, n) = 6n^2 - 11n + 6 = (7n - 6) + (6n^2 - 18n + 12)
--                          = 1 + 7(n - 1) + 6(n - 1)(n - 2)
-- O(4, n) = 1 + 7(n - 1) + 6(n - 1)(n - 2) + (n - 1)(n - 2)(n - 3)
--         = 6n^2 - 11n + 6 + (n - 3)(n^2 - 3n + 2)
--         = 6n^2 - 11n + 6 + n^3 - 3n^2 + 2n - 3n^2 + 9n - 6
--         = n^3

-- n^3 = 1 + (n^3 - 1)
--     = 1 + (n - 1)(n^2 + n + 1)
--     = 1 + (n - 1)(7 + (n^2 + n - 6))
--     = 1 + 7(n - 1)+ (n - 1)(n - 2)(n + 3)
--     = 1 + 7(n - 1)+ (n - 1)(n - 2)(6 + (n - 3))
--     = 1 + 7(n - 1)+ 6(n - 1)(n - 2) + (n - 1)(n - 2)(n - 3)

-- u(n) = 1 - n + n^2 - n^3 + n^4 - n^5 + n^6 - n^7 + n^8 - n^9 + n^10
--      = 1 + (n - 1)(n + n^3 + n^5 + n^7 + n^9)
--      = 1 + (n - 1)(682 + (n^9 + n^7 + n^5 + n^3 + n - 682))
--      = 1 + 682(n - 1) + (n - 1)(n^9 - 2n^8 + 2n^8 - 4n^7 + 5n^7 - 10n^6 + 10n^6 - 20n^5 + 
--                                 21n^5 - 42n^4 + 42n^4 - 84n^3 + 85n^3 - 170n^2 + 170n^2 - 340n +
--                                 341n - 682)
--      = 1 + 682(n - 1) + (n - 1)(n - 2)(n^8 + 2n^7 + 5n^6 + 10n^5 + 21n^4 + 42n^3 + 85n^2 + 170n + 341)
--      = 1 + 682(n - 1) + (n - 1)(n - 2)(21461 + ...

-- u(n) = a0 + a1(n - 1) + a2(n - 1)(n - 2) + ... + a10(n - 1)(n - 2)...(n - 10)


-- for k <= 10:
-- OP(k, n) = a0 + a1(n - 1) + ... a{k-1}(n - 1)(n - 2)...(n - k + 1)
-- FIT(k) = OP(k, k + 1)
-- result = sum of FIT(k) from 1 to 10


import Data.Array (listArray, array, (!))


fact = array (0, 11) $ (0, 1) : [ (i, i * (fact ! (i - 1))) | i <- [1..11] ]


calcU :: Integer -> Integer
calcU n = sum $ map ((-n)^) [0..10]
--calcU n = n^3

u = listArray (1, 12) $ map calcU [1..12]
-- [1,683,44287,838861,8138021,51828151,247165843,954437177,3138105961,9090909091,23775972551,57154490053]


calcA :: Integer -> Integer
calcA 0 = u ! 1
calcA k = (u ! (k + 1) - calcOP k (k + 1)) `div` (fact ! k)

-- calcA 1 = (u ! 2 - calcOP 1 2) `div` (fact ! 1) = (683 - a0) `div` 1 = 683 - 1 = 682
-- calcA 2 = (u ! 3 - calcOP 2 3) `div` (fact ! 2) = (44287 - (a0 + a1(3 - 1))) `div` 2
--         = (44287 - (1 + 682 * 2)) `div` 2 = (44287 - 1365) `div` 2 = 42922 `div` 2 = 21461

a = listArray (0, 11) $ map calcA [0..11]
-- [1,682,21461,118008,210232,159060,58542,11165,1111,54,1,0]


calcOP :: Integer -> Integer -> Integer
calcOP k n = sum [ (a ! i) * (product (1 : [ n - j | j <- [1..i] ])) | i <- [0..k-1] ]

-- calcOP 1 n = sum [ (a ! i) * product 1 | i <- [0..0] ] = sum [a ! 0] = a ! 0 = 1
-- calcOP 2 n = sum [ (a ! 0) * product 1, (a ! 1) * product [ n - j | j <- [1..1] ] ]
--            = sum [1, 682 * (n - 1)] = 1 + 682 * (n - 1)


calcFIT k = calcOP k (k + 1)


main = print $
       sum $ map calcFIT [1..10]
-- 37076114526

-- [1,1365,130813,3092453,32740951,205015603,898165577,3093310441,9071313571,23772343751]
